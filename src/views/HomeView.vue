<template lang="">
  <div>
    <table>
      <thead>
        <tr>
          <th colspan="1">Nom & prénom</th>
          <th colspan="2">Lundi</th>
          <th colspan="2">Mardi</th>
          <th colspan="2">Mercredi</th>
          <th colspan="2">Jeudi</th>
          <th colspan="2">Vendredi</th>
        </tr>
        <tr>
          <th colspan="1"></th>
          <th colspan="1">AM</th>
          <th colspan="1">PM</th>
          <th colspan="1">AM</th>
          <th colspan="1">PM</th>
          <th colspan="1">AM</th>
          <th colspan="1">PM</th>
          <th colspan="1">AM</th>
          <th colspan="1">PM</th>
          <th colspan="1">AM</th>
          <th colspan="1">PM</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>nom 1</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 2</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 3</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 4</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 5</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 6</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 7</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 8</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 9</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 10</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 11</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 12</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 13</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>
        <tr>
          <td>nom 14</td>
          <td class="lundiAm"></td>
          <td class="lundiPm"></td>
          <td class="mardiAm"></td>
          <td class="mardiPm"></td>
          <td class="mercrediAm"></td>
          <td class="mercrediPm"></td>
          <td class="jeudiAm"></td>
          <td class="jeudiPm"></td>
          <td class="vendrediAm"></td>
          <td class="vendrediPm"></td>
        </tr>

      </tbody>
    </table>
    <div>
      <button @click="generatePlanning()"> généré un planning aléatoire</button>
      <button @click="deletePlanning()">supprimer le planning</button>
      <button @click="downloadsTable()">télécharger le tableau</button>
    </div>
    <div class="container">

      <div>
        <div id="taskList" class="row">
          <addTask id="task1" v-if="taskNbr >1" />
          <addTask id="task2" v-if="taskNbr >2" />
          <addTask id="task3" v-if="taskNbr >3" />
          <addTask id="task4" v-if="taskNbr >=4" />
          <addTask id="task5" v-if="taskNbr >=5" />
          <addTask id="task6" v-if="taskNbr >=6" />
          <addTask id="task7" v-if="taskNbr >=7" />
          <addTask id="task8" v-if="taskNbr >=8" />
          <addTask id="task9" v-if="taskNbr >=9" />
          <addTask id="task10" v-if="taskNbr >=10" />
        </div>
        <div>
          <button @click="addTask()">add task</button>
          <button @click="submitTasks()">submit task</button>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import addTask from "./addtask.vue"
  export default {
    name: 'HomeView',
    components: {
      addTask
    },
    data() {
      return {
        taskNbr:4,
        taches: {
          "guichet": {
            jour: 'tous',
            nbrAm: 2,
            nbrPm: 2
          },
          "chimio": {
            jour: 'tous',
            nbrAm: 2
          },
          "prepMag": {
            jour: 'tous',
            nbrPm: 1
          },
          "TPNNeon": {
            jour: ['lundi', 'mardi', 'jeudi', 'vendredi'],
            nbrPm: 2
          },
          "Chariots": {
            jour: 'tous',
            nbrAm: 1
          },
          "USI": {
            jour: 'tous',
            nbrPm: 2
          },
          "Stups": {
            jour: ['mercredi'],
            nbrAm: 2
          },
          "Urgences": {
            jour: 'tous',
            nbrPm: 1
          },
          "Ophtalmo": {

          },
          "Colis": {
            jour: 'tous',
            nbrPm: 1
          },
          "QOp": {
            jour: ['lundi', 'jeudi'],
            nbrPm: 2
          },
          "satellites": {

          },
          "Encodage": {
            jour: 'tous',
            nbrAm: 1
          }
        },
        planningGrid: [
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          [],
          []
        ],
        planningGridVersionTwo: {
          nom1: [],
          nom2: [],
          nom3: [],
          nom4: [],
          nom5: [],
          nom6: [],
          nom7: [],
          nom8: [],
          nom9: [],
          nom10: [],
          nom11: [],
          nom12: [],
          nom13: [],
          nom14: []
        },
        planningDays: {
          lundiAm: [],
          lundiPm: [],
          mardiAm: [],
          mardiPm: [],
          mercrediAm: [],
          mercrediPm: [],
          jeudiAm: [],
          jeudiPm: [],
          vendrediAm: [],
          vendrediPm: []
        },
        jour: ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi'],
        timeStamp: ['lundiAm', 'lundiPm', 'mardiAm', 'mardiPm', 'mercrediAm', 'mercrediPm', 'jeudiAm', 'jeudiPm', 'vendrediAm', 'vendrediPm']

      }
    },
    methods: {
      generatePlanning() {

        this.planningDays = {
          lundiAm: [, , , , , , , 'fixe', , , , , , 'fixe'],
          lundiPm: [, , , , , , , 'fixe', , , , , , 'fixe'],
          mardiAm: [, , , , , , , , , 'fixe', , , , 'fixe'],
          mardiPm: [, , , , , , , , , 'fixe', , , , 'fixe'],
          mercrediAm: [, , , 'fixe', , 'fixe', 'fixe', , , , , 'fixe'],
          mercrediPm: [, , , 'fixe', , 'fixe', 'fixe', , , , , 'fixe'],
          jeudiAm: [],
          jeudiPm: [],
          vendrediAm: [, 'fixe'],
          vendrediPm: [, 'fixe']
        }

        for (let t in this.planningDays) {
          for (let u = 0; u < 14; u++) {
            document.getElementsByClassName(t)[u].innerHTML = ""
            document.getElementsByClassName(t)[u].className = t
          }
        }

        for (let i in this.taches) {
          for (let x in this.taches[i]) {
            if (x == "jour") {
              if (this.taches[i][x] == "tous") {
                if ("nbrAm" in this.taches[i]) {
                  for (let y = 0; y < this.taches[i]["nbrAm"]; y++) {

                    for (let z in this.planningDays) {
                      if (z.endsWith('Am')) {
                        let randomWorker = Math.floor(Math.random() * (14 - 0) + 0)
                        while (undefined != this.planningDays[z][randomWorker]) {
                          randomWorker = Math.floor(Math.random() * (14 - 0) + 0)

                        }
                        this.planningDays[z][randomWorker] = i
                      } else {
                        continue
                      }

                    }
                  }
                }
                if ("nbrPm" in this.taches[i]) {
                  for (let y = 0; y < this.taches[i]["nbrPm"]; y++) {
                    for (let z in this.planningDays) {
                      if (z.endsWith('Pm')) {
                        let randomWorker = Math.floor(Math.random() * (14 - 0) + 0)
                        while (undefined != this.planningDays[z][randomWorker]) {
                          randomWorker = Math.floor(Math.random() * (14 - 0) + 0)

                        }
                        this.planningDays[z][randomWorker] = i

                      }
                    }

                  }
                }
              } else {
                for (let j of this.taches[i][x]) {
                  if ("nbrAm" in this.taches[i]) {
                    for (let y = 0; y < this.taches[i]["nbrAm"]; y++) {

                      for (let z in this.planningDays) {
                        if (z.endsWith(j+'Am')) {
                          let randomWorker = Math.floor(Math.random() * (14 - 0) + 0)
                          while (undefined != this.planningDays[z][randomWorker]) {
                            randomWorker = Math.floor(Math.random() * (14 - 0) + 0)

                          }
                          this.planningDays[z][randomWorker] = i
                        } else {
                          continue
                        }

                      }
                    }
                  }
                  if ("nbrPm" in this.taches[i]) {
                    for (let y = 0; y < this.taches[i]["nbrPm"]; y++) {
                      for (let z in this.planningDays) {
                        if (z.endsWith(j+'Pm')) {
                          let randomWorker = Math.floor(Math.random() * (14 - 0) + 0)
                          while (undefined != this.planningDays[z][randomWorker]) {
                            randomWorker = Math.floor(Math.random() * (14 - 0) + 0)

                          }
                          this.planningDays[z][randomWorker] = i

                        } else {
                          continue
                        }
                      }

                    }
                  }
                }
              }

            }

          }
        }
        for (let t in this.planningDays) {
          for (let u = 0; u < 14; u++) {
            document.getElementsByClassName(t)[u].innerHTML = this.planningDays[t][u]
            document.getElementsByClassName(t)[u].className += " " + this.planningDays[t][u]
          }
        }
      },
      deletePlanning() {
        this.planningDays = {
          lundiAm: [],
          lundiPm: [],
          mardiAm: [],
          mardiPm: [],
          mercrediAm: [],
          mercrediPm: [],
          jeudiAm: [],
          jeudiPm: [],
          vendrediAm: [],
          vendrediPm: []
        }

        for (let t in this.planningDays) {
          for (let u = 0; u < 14; u++) {
            document.getElementsByClassName(t)[u].innerHTML = ""
            document.getElementsByClassName(t)[u].className = t
          }
        }
      },
      downloadsTable(){
console.log('downloadsTable')
      },
      addTask(){
        if(this.taskNbr<=10){
          this.taskNbr=1+this.taskNbr
        }
        
        console.log(this.taskNbr)
        
      },
      submitTasks(){

      }
      
    },
    computed: {

    }

  }
</script>
<style lang="">

</style>